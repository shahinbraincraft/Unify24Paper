<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MeiCam SDK For Android: Question list</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MeiCam SDK For Android
   &#160;<span id="projectnumber">3.5.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Question list </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ol type="1">
<li><a class="el" href="QuestionList_8md.html#How">to generate a square video 1.How to generate a square video?</a> to generate a square video "How to generate a square video?"</li>
<li><a class="el" href="QuestionList_8md.html#How">to generate a square video 1.How to generate a square video?</a> to generate a video with skin beautification effect "How to generate a video with skin beautification effect?"</li>
<li>[How to generate a single video file by multiple materials?]] (<a class="el" href="QuestionList_8md.html#How">to generate a square video 1.How to generate a square video?</a> to generate a single video file by multiple materials)</li>
<li><a class="el" href="QuestionList_8md.html#How">to generate a square video 1.How to generate a square video?</a> to realize picture-in-picture effect "How to realize picture-in-picture effect?"</li>
<li><a class="el" href="QuestionList_8md.html#How">to generate a square video 1.How to generate a square video?</a> to add a watermark "How to add a watermark?"</li>
<li><a class="el" href="QuestionList_8md.html#There">is no problem from the recording interface to the playback interface. After returning, the recording interface is black. 6.There is no problem from the recording interface to the playback interface. After returning, the recording interface is black.</a> is no problem from the recording interface to the playback interface. After returning, the recording interface is black. "There is no problem from the recording interface to the playback interface. After returning, the recording interface is black."</li>
<li><a class="el" href="QuestionList_8md.html#NvsColor">setting is invalid 7.NvsColor setting is invalid?</a> setting is invalid "NvsColor setting is invalid"</li>
<li><a class="el" href="QuestionList_8md.html#From">the recording interface to the playback interface, the LiveWindow of the playback interface flashes to black and back to normal 8.From the recording interface to the playback interface, the LiveWindow of the playback interface flashes to black and back to normal</a> the recording interface to the broadcast interface, the LiveWindow of the broadcast interface flashes black and then works normally "From the recording interface to the broadcast interface, the LiveWindow of the broadcast interface flashes black and then works normally"</li>
<li><a class="el" href="QuestionList_8md.html#Is">the screen orientation of the video recorded by some mobile phones not working properly 9.Is the screen orientation of the video recorded by some mobile phones not working properly?</a> the screen orientation of the video recorded by some mobile phones not working properly "Is the screen orientation of the video recorded by some mobile phones not working properly?"</li>
<li><a class="el" href="QuestionList_8md.html#Code">confusion error caused by using the Effect SDK under Android? 1.Code confusion error caused by using the Effect SDK under Android?</a> confusion error caused by using Meishe SDK under Android "Code confusion error caused by using Meishe SDK under Android?"</li>
<li><a class="el" href="QuestionList_8md.html#How">to generate a square video 1.How to generate a square video?</a> to use H265 for video shooting and generation "How to use H265 for video shooting and generation?"</li>
</ol>
<hr  />
<h1><a class="anchor" id="Detailed"></a>
explanation</h1>
<h2><a class="anchor" id="How"></a>
to generate a square video 1.How to generate a square video?</h2>
<p>Assuming the video is taken in a vertical resolution of 1280*720, and users want to generate a 720*720 video. <br  />
1)Create timeline </p><pre class="fragment">\if IOS
    NvsVideoResolution videoEditRes;
    videoEditRes.imageWidth = 720;
    videoEditRes.imageHeight = 720;
    videoEditRes.imagePAR = (NvsRational){1, 1};
    NvsRational videoFps = {25, 1};
    NvsAudioResolution audioEditRes;
    audioEditRes.sampleRate = 48000;
    audioEditRes.channelCount = 2;
    audioEditRes.sampleFormat = NvsAudSmpFmt_S16;
    //Create timeline.
    m_timeline = [streamingContext createTimeline:&amp;videoEditRes videoFps:&amp;videoFps audioEditRes:&amp;audioEditRes];
\endif
\if ANDROID
    NvsVideoResolution videoEditRes = new NvsVideoResolution();
    videoEditRes.imageWidth = 720;
    videoEditRes.imageHeight = 720;
    videoEditRes.imagePAR = new NvsRational(1, 1);
    NvsRational videoFps = new NvsRational(25, 1);
    NvsAudioResolution audioEditRes = new NvsAudioResolution();
    audioEditRes.sampleRate = 48000;
    audioEditRes.channelCount = 2;
    //Create timeline.
    m_timeline = streamingContext.createTimeline(videoEditRes, videoFps, audioEditRes);    
\endif
</pre><p>2)Create tracks and clips. Path is the absolute path of the clip. </p><pre class="fragment">\if IOS
    NvsVideoTrack videoTrack = [m_timeline appendVideoTrack];
    NvsVideoClip clip = [videoTrack appendClip:path];
\endif
\if ANDROID
    NvsVideoTrack videoTrack = m_timeline.appendVideoTrack();
    NvsVideoClip clip = videoTrack.appendClip(path);    
\endif
</pre><p>3)Zoom in the video. </p><pre class="fragment">\if IOS
    [clip setPan:0 andScan:1];
\endif
\if ANDROID
    clip.setPanAndScan(0, 1);    
\endif
</pre><p>For detailed settings, please refer to<a class="el" href="Pan_Scan_8md.html">Pan and Scan</a> <br  />
4)Generate video. Path is the path to generate video. </p><pre class="fragment">\if IOS
    [m_streamingContext compileTimeline:m_timeline startTime:0 endTime:m_timeline.duration outputFilePath:path videoResolutionGrade:COMPILE_VIDEO_RESOLUTION_GRADE_720 
    videoBitrateGrade:COMPILE_BITRATE_GRADE_HIGH flags:0];
\endif    
\if ANDROID
    m_streamingContext.compileTimeline(m_timeline, 0, m_timeline.getDuration(), path, NvsStreamingContext.COMPILE_VIDEO_RESOLUTION_GRADE_720
    , NvsStreamingContext.COMPILE_BITRATE_GRADE_HIGH, 0);
\endif
</pre><h2><a class="anchor" id="How"></a>
to generate a square video 1.How to generate a square video?</h2>
<p>1)Create timeline,track, and clip. This part is the same as that of question one. <br  />
2)Add beauty effect. </p><pre class="fragment">\if IOS
    [clip appendBeautyFx];
\endif    
\if ANDROID
    clip.appendBeautyFx();
\endif
</pre><p>3)Generate video.</p>
<h2><a class="anchor" id="How"></a>
to generate a square video 1.How to generate a square video?</h2>
<p>1)Add multiple materials to create multiple clips when creating tracks and clips. </p><pre class="fragment"> \if IOS
    NvsVideoTrack videoTrack = [m_timeline appendVideoTrack];
    NvsVideoClip clip1 = [videoTrack appendClip:path1];
    NvsVideoClip clip2 = [videoTrack appendClip:path2];
    NvsVideoClip clip3 = [videoTrack appendClip:path3];
    NvsVideoClip clip4 = [videoTrack appendClip:path4];
    NvsVideoClip clip5 = [videoTrack appendClip:path5];
\endif
\if ANDROID
    NvsVideoTrack videoTrack = m_timeline.appendVideoTrack();
    NvsVideoClip clip1 = videoTrack.appendClip(path1);
    NvsVideoClip clip2 = videoTrack.appendClip(path2);
    NvsVideoClip clip3 = videoTrack.appendClip(path3);
    NvsVideoClip clip4 = videoTrack.appendClip(path4);
    NvsVideoClip clip5 = videoTrack.appendClip(path5);
\endif
</pre><p>2)Generate video. </p><pre class="fragment">\if IOS
    [m_streamingContext compileTimeline:m_timeline startTime:0 endTime:m_timeline.duration outputFilePath:path videoResolutionGrade:COMPILE_VIDEO_RESOLUTION_GRADE_720 
    videoBitrateGrade:COMPILE_BITRATE_GRADE_HIGH flags:0];
\endif    
\if ANDROID
    m_streamingContext.compileTimeline(m_timeline, 0, m_timeline.getDuration(), path, NvsStreamingContext.COMPILE_VIDEO_RESOLUTION_GRADE_720
    , NvsStreamingContext.COMPILE_BITRATE_GRADE_HIGH, 0));
\endif  
</pre><p>In this way a file can be generated.</p>
<h2><a class="anchor" id="How"></a>
to generate a square video 1.How to generate a square video?</h2>
<p>A simple picture-in-picture effect refers to superimposed effect of two images(videos) with two different resolutions, such as a horizontally-shot image(video) and a vertical-shot image(video), being added to two tracks. In addition, the Transform 2D effect can realize zooming in and out, rotation, and increasing the level transparency to the video. </p><pre class="fragment">\if IOS
    NvsVideoTrack videoTrack1 = [m_timeline appendVideoTrack];
    NvsVideoTrack videoTrack2 = [m_timeline appendVideoTrack];
    NvsVideoClip clip1 = [videoTrack1 appendClip:path1];
    NvsVideoClip clip2 = [videoTrack2 appendClip:path2];
\endif    
\if ANDROID
    NvsVideoTrack track1 = m_timeline.appendVideoTrack();
    NvsVideoTrack track2 = m_timeline.appendVideoTrack();
    NvsVideoClip clip1 = track1.appendClip(path1);
    NvsVideoClip clip2 = track2.appendClip(path2);
\endif
</pre><h2><a class="anchor" id="How"></a>
to generate a square video 1.How to generate a square video?</h2>
<p>There are two ways to add a watermark: one can be done by the sticker function, in which users are required to send a watermarked image which will be done by Meishe. The finished watermark file is a file with UUID as the name and .animatedsticker as the extension. With this file, users can realize the function of adding watermarks through API. </p><pre class="fragment">\if IOS
    NSMutableString *m_stickerId;
    NSString *packagePath = [appPath stringByAppendingPathComponent:@"89740AEA-80D6-432A-B6DE-E7F6539C4121.animatedsticker"];
    NvsAssetPackageManagerError error = [m_streamingContext.assetPackageManager installAssetPackage:packagePath license:nil type:NvsAssetPackageType_VideoFx sync:YES assetPackageId:m_stickerId];
    if (error != NvsAssetPackageManagerError_NoError &amp;&amp; error != NvsAssetPackageManagerError_AlreadyInstalled) {
        NSLog(@"Failed to install video fx package!");
        package1Valid = false;
    }

    [m_timeline addAnimatedSticker:0 duration:m_timeline.duration animatedStickerPackageId:_stickerPackageId];
\endif
\if ANDROID
    StringBuilder m_stickerId = new StringBuilder();
    packagePath = "assets:/89740AEA-80D6-432A-B6DE-E7F6539C4121.animatedsticker";
    error = m_streamingContext.getAssetPackageManager().installAssetPackage(packagePath, null, NvsAssetPackageManager.ASSET_PACKAGE_TYPE_ANIMATEDSTICKER, true, m_stickerId);
        if (error != NvsAssetPackageManager.ASSET_PACKAGE_MANAGER_ERROR_NO_ERROR
                &amp;&amp; error != NvsAssetPackageManager.ASSET_PACKAGE_MANAGER_ERROR_ALREADY_INSTALLED) {
        Log.e(TAG, "Failed to install sticker package!");
    }

    m_timeline.addAnimatedSticker(0, m_timeline.getDuration(),m_stickerId.toString());
\endif    
</pre><p>The second way of adding a watermark is invocate the addWatermark() interface in the NvsTimeline class. </p><pre class="fragment">\if IOS
    [m_timeline addWatermark:path displayWidth:0 displayHeight:0 opacity:1 position:NvsTimelineWatermarkPosition_TopRight marginX:0 marginY:0];//Path is the path of the watermark file, which must be in a PNG or JPG format.
\endif    
\if ANDROID
    m_TimeLine.addWatermark(path, 0, 0, 1, NvsTimeline.NvsTimelineWatermarkPosition_TopLeft, 0, 0);//Path is the path of the watermark file, which can be in PNG,JPG fromat or .caf format.
\endif    
</pre><h2><a class="anchor" id="There"></a>
is no problem from the recording interface to the playback interface. After returning, the recording interface is black. 6.There is no problem from the recording interface to the playback interface. After returning, the recording interface is black.</h2>
<p>Check if the connectCapturePreviewWithLiveWindow() interface in the NvsStreamingContext class has been called normally, or if users call stop() on the NvsStreamingContext after calling startCapturePreivew(). Similarly, the case that from recording interface to play interface displays a black screen which might be caused by calling stop() of NvsStreamingContext after playbackTimeline(). It is also possible that the connectTimelineWithLiveWindow method on the NvsStreamingContext has not been called or called abnormally.</p>
<h2><a class="anchor" id="NvsColor"></a>
setting is invalid 7.NvsColor setting is invalid?</h2>
<p>The NvsClor's fields are in float type, and R, G, B, and A have values from 0 to 1. If the given color values are 100, 100, 100 , they need to be divided by 255 respectively.</p>
<h2><a class="anchor" id="From"></a>
the recording interface to the playback interface, the LiveWindow of the playback interface flashes to black and back to normal 8.From the recording interface to the playback interface, the LiveWindow of the playback interface flashes to black and back to normal</h2>
<p>Calling playbackTimeline to play needs to preview for a while. In order to avoid this problem, users need to first call seekTimeline interface to 0 position. in this way the flash black problem will not occur.</p>
<h2><a class="anchor" id="Is"></a>
the screen orientation of the video recorded by some mobile phones not working properly 9.Is the screen orientation of the video recorded by some mobile phones not working properly?</h2>
<p>The reasons may be that some mobile phone players do not support automatic rotation, which may cause the image orientation to be abnormal during video playback, and this may misleading users. </p>
<h2><a class="anchor" id="Code"></a>
confusion error caused by using the Effect SDK under Android? 1.Code confusion error caused by using the Effect SDK under Android?</h2>
<p>When using code confusion, please be careful to avoid apply confusion operation on the following classes. The correct way to avoid this error is as follows: </p><pre class="fragment">-keep class com.cdv.**  {*;}
-keep class com.meicam.**  {*;}
</pre><p>When using effectsdk alone, please be careful to avoid apply confusion operation on the following classes. The correct way to avoid this error is as follows: </p><pre class="fragment">-keep class com.cdv.effect.**  {*;}
-keep class com.meicam.effect.**  {*;}
</pre><h2><a class="anchor" id="How"></a>
to generate a square video 1.How to generate a square video?</h2>
<p>The use of H265 for video shooting is as follows: </p><pre class="fragment">\if IOS
    NSMutableDictionary *config = [[NSMutableDictionary alloc] init];
    [config setValue:@"hevc" forKey:NVS_COMPILE_VIDEO_ENCODEC_NAME];
    [context startRecording:filePath withFlags:0 withRecordConfigurations:config];
\endif    
\if ANDROID
    Hashtable&lt;String, Object&gt; config = new Hashtable&lt;&gt;();
    config.put(NvsStreamingContext.COMPILE_VIDEO_ENCODER_NAME, "hevc"); //h265 mode
    context.startRecording(filePath, 0, config);
\endif
</pre><p>The use of H265 for video generation is as follows: </p><pre class="fragment">\if IOS
    NSMutableDictionary *config = [[NSMutableDictionary alloc] init];
    [config setValue:@"hevc" forKey:NVS_COMPILE_VIDEO_ENCODEC_NAME];//h265 mode
    context.compileConfigurations = config;//Setted before compileTimeline API invocked
    [context compileTimeline:timeline startTime:0 endTime:timeline.duration outputFilePath:ouputPath videoResolutionGrade:NvsCompileVideoResolutionGrade720 videoBitrateGrade:NvsCompileBitrateGradeHigh flags:0];
\endif    
\if ANDROID
    Hashtable&lt;String, Object&gt; config = new Hashtable&lt;&gt;();
    config.put(NvsStreamingContext.COMPILE_VIDEO_ENCODER_NAME, "hevc"); //h265 mode
    context.setCompileConfigurations(config);//Setted before compileTimeline API invocked
    context.compileTimeline(timeline, startTime, endTime, compileVideoPath, NvsStreamingContext.COMPILE_VIDEO_RESOLUTION_GRADE_720, NvsStreamingContext.COMPILE_BITRATE_GRADE_HIGH,0);
\endif
</pre><dl class="section warning"><dt>Warning</dt><dd><br  />
 Not all android models can support H265 shooting and generation. If not, please configure the default settings for video shooting and generation. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
